<html>
    <head>
        <meta charset = "utf-8">
        <title>불암산</title>
        <link rel = "stylesheet" type = "text/css" href = "minor.css">
        <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">
    </head>
    <body>
        <h1 id = "locationtitle">여기는 불암산!</h1>        
        
        <div>
            <div id = "container">
                <h1>노을 볼 확률</h1>
                <div id ="sunset"></div>
                <p id="rainfall"></p>
                <img id="rainfallpic">
                <p id="landslide"></p>
                <p id="trailinfo"></p>
                <p id="firealert">불암산의 산불 위험 지수는 평균보다 현저히 낮으므로 안전합니다!</p>
            </div>
            <div id="info">
                <hr>
                <h2>산 정보</h2>
                <p>불암산은 서울시와 경기 남양주의 경계를 이루며 덕능고개를 사이에 두고 수락산과 이웃하고 있다. 서울시 경계에 위치한 5개 산 가운데 가장 낮은 산이다. 그러나 정상부분이 온통 바위산을 이루고 있어 규모를 뛰어넘는 기품을 자랑한다."</p>
                <p>불암산 주봉은 해발 507m이고 그 형상이 마치 송낙(소나무 겨우 살이로 만든 여승이 쓰는 모자)을 쓴 부처의 모습과 같다 하여 불암산이라 불리게 되었으며 천보산(天寶山), 필암산(筆岩山) 이라는 이름도 가지고 있다. 불암산은 사암으로 된 산이라 수목이 울창하지는 않으나 능선은 기암으로 이어지고 봄의 철쭉은 화원을 연상케 한다. 북한산, 도봉산, 관악산 등과 더불어 서울 근교의 산으로 교통편이 좋기 때문에 많은 등산객이 찾는 곳이다.</p>
                <hr>
                <h2>편의 시설</h2>
                <p>청암 약수터, 상계 약수터, 용천 약수터, 통일 약수터, 돌산 약수터, 불암 약수터, 정암샘 약수터가 있습니다.</p>
                <hr>
                <h2>볼거리</h2>
                <p>불암사, 불암폭포</p>
                <hr>
            </div>
            
            <div id="sightseeing">
                <h5>제 1코스</h5>
                <p>상계역- 재현중고- 정암사- 주능선- 정상- 상계 전철역</p>
                <h5>제 2코스</h5>
                <p>상계역-영신1슬랩-영신2슬랩-해골바위-헬기장-정상-불암공원</p>
                <h5>제 3코스</h5>
                <p>중계동-학도암-봉화대터-불암산 (5.5km, 2:00)</p>
                <h5>제 4코스</h5>
                <p>태릉-불암산-덕릉고개-흥국사-수락산-의정부시 (15km, 6:30)</p>
                <h5>제 5코스</h5>
                <p>불암동- 불암사- 석천동- 정상- 덕능고개- 상계동 버스종점 (2:00)</p>

        <script>
            
            
            const url_rainfall = "http://openAPI.seoul.go.kr:8088/6c4a6d756673657233346142775674/json/ListRainfallService/1/100/";
                fetch(url_rainfall, {
                    headers : { 
                    'Content-Type': 'application/json',
                    'Accept': 'application/json'
                        }
                })
                .then(res => res.json())
                .then(myJson => {
                    
                    //document.getElementById('rainfall').innerText = JSON.stringify(myJson);
                    rainfall_length = JSON.stringify(myJson["ListRainfallService"]["row"]).length

                    
                    for (var i = 0; i < rainfall_length; i++){
                        let 구명 = JSON.stringify(myJson["ListRainfallService"]["row"][i].GU_NAME);
                        if (구명 == '"노원구"'){
                            flag = i
                            break;
                        } 
                        else{
                            continue;
                        }
                    
                    }

                    //강우량
                    let 강우량 = JSON.stringify(myJson["ListRainfallService"]["row"][flag].RAINFALL10); 

                    강우량 = parseInt(강우량);

                    let 노을확률 = ""
                    if(강우량 = "0"){
                        노을확률 = "매우 높아요";
                        노을사진 = "./images/thumbsup.png"
                    }else {
                        노을확률 = "아마 보기 어려울 거에요";
                        노을사진 = "./images/thumbsdown.png"
                    }

                    document.getElementById('rainfall').innerText += "\n"+ "불암산 정상 등반 시 노을을 관찰할 확률은 " + 노을확률 ;
                    document.getElementById('rainfallpic').src = 노을사진;
                    

                    
                });
                fetch(`https://api.allorigins.win/raw?url=${encodeURIComponent('http://apis.data.go.kr/1400000/predictionInfoService/predictionInfoList?ServiceKey=pgSFXq7JRCZhMaWViaF%2FyAF0ICZWKle3przI5MSYiq%2FP89Qn8A5cHZn1RbTB56IwbIh3eTLkyuBQy%2Bv9A9PewA%3D%3D&_type=json&numOfRows=1000')}`)
                .then(response => {
                    if (response.ok) return response.json()
                    throw new Error('Network response was not ok.')
                })
                .then(myJson => {
                //document.getElementById('landslide').innerText = JSON.stringify(myJson);
                //console.log(JSON.stringify(myJson['response']['body']['items']['item']));
                console.log(JSON.stringify(myJson['response']['body']['items']['item'][0]));

                const landslide_length = JSON.stringify(myJson['response']['body']['items']['item'].length);

                var obj = [];
                for (var i = 0; i < landslide_length; i++){
                    const name = JSON.stringify(myJson['response']['body']['items']['item'][i].sgg);
                    console.log(JSON.stringify(myJson['response']['body']['items']['item'][i].sgg));

                    obj[JSON.stringify(myJson['response']['body']['items']['item'][i].sgg)] = (obj[JSON.stringify(myJson['response']['body']['items']['item'][i].sgg)] || 0) + 1;
                }    
                    console.log(obj)
                
                
                    for (var key in obj){
                    let 산사태예보 = ""
                    if(obj[key]> 20 ){
                        산사태예보  = "의 산사태 가능성이 높으므로, 등산 하지 마세요!";
                    }else if (obj[key]> 15){
                        산사태예보  = "의 산사태 가능성이 보통이므로, 등산하는 걸 자제하세요!";
                    }else if (obj[key]> 10){
                        산사태예보  = "의 산사태 가능성이 낮으므로, 안전한 편이에요!";
                    }else if (obj[key]> 5){
                        산사태예보  = "의 산사태 가능성이 매우 낮으므로, 안전해요:)";
                    }else {
                        산사태예보  = "의 산사태 예측 정보 시스템이 점검 중이어서 정보 제공이 어렵습니다.";
                    }
                    
                    if(key=='"서울특별시 노원구"'){
                    document.getElementById('landslide').innerText +="불암산"+ 산사태예보 ;
                    //콘솔창에 지역 확인
                }
            }
                });
                
        </script>
    </body>
</html>