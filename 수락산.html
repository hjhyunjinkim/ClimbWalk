<html>
    <head>
        <meta charset = "utf-8">
        <title>수락산</title>
        <link rel = "stylesheet" type = "text/css" href = "minor.css">
        <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">
    </head>
    <body>
        <h1 id = "locationtitle">여기는 수락산!</h1>        
        
        <div>
            <div id = "container">
                <h1>노을 볼 확률</h1>
                <div id ="sunset"></div>
                <p id="rainfall"></p>
                <img id="rainfallpic">
                <p id="landslide"></p>
                <p id="trailinfo"></p>
                <p id="firealert">수락산의 산불 위험 지수는 평균보다 현저히 낮으므로 안전합니다!</p>
            </div>
            <div id="info">
                <h2>산 정보</h2>
                <p>수락산은 서울의 북쪽 끝에 의정부시와 남양주군을 경계로 하고 있으며 남쪽으로 불암산이 바로 연결되어 있어 종주가 가능하다. 산 전체가 화강암과 모래로 이루어져 있고 기암 괴석과 샘, 폭포가 많은 반면 나무는 매우 적다. 산의 분위기가 다소 삭막하기는 하나 바위의 경치가 뛰어나고 곳곳에 맑은 물이 흘러내린다.</p>
                <p>수락 8경이라 불리는 금류폭, 은류폭, 옥류폭포와 신라 때의 흥국사, 조선 때의 내원암이 있다. 그리고 동서 산록의 계곡에는 수락산 유원지와 벽운동 유원지가 있다.</p>
                <p>산세가 웅장할 뿐만 아니라 산 전체가 석벽과 암반으로 되어 있어 도처에 기암괴석이 즐비하다. 장암동에는 조선 숙종 때 형조판서를 지낸 서계 박세당의 정자인 6각형의 궤산정이 있으며, 현재의 석림사는 박제사의 후신이다.</p>
                <hr>
                <h2>편의 시설</h2>
                <p>수락 약수터, 구암 약수터, 산신제 약수터, 쫄쫄이 약수터 및 체육 시설이 있습니다.</p>
                <hr>
                <h2>볼거리</h2>
                <p>수락팔경(옥류폭포, 은류폭포, 금류폭포, 성인봉 영락대, 미륵봉 백운, 향로봉 청풍, 칠성대 기암, 불로정 약수), 궤산정, 석림사, 내원암, 흥국사, 학림사</p>
                <hr>
            </div>
            <div id="sightseeing">
                <h5>제 1코스</h5>
                <p>수락산역-미주아파트-시립양노원-계곡- 깔딱고개- 암릉코스- 철모바위- 정상- 철모바위- 540봉- 수락산역 [6시간]</p>
                <h5>제 2코스</h5>
                <p>장암역- 노강서원- 석림사- 왼쪽 능선- 정상 [2시간]</p>
                <h5>제 3코스</h5>
                <p>장암역- 석림사- 계곡- 암릉지대- 철모바위- 정상 [2시간]</p>
                <h5>제 4코스</h5>
                <p>당고개역- 540봉- 철모바위- 정상</p>
                <h5>제 5코스</h5>
                <p>유원지입구 버스승강장 -(20분)- 유원지 -(20분)- 매표소 - (40분)- 내원암 -(40분)- 수락산 -(10분)- 620봉 -(서쪽암릉길 20분)- 고개 - (30분)- 석림사 -(20분)- 하촌</p>

        <script>
            
            
            const url_rainfall = "http://openAPI.seoul.go.kr:8088/6c4a6d756673657233346142775674/json/ListRainfallService/1/100/";
                fetch(url_rainfall, {
                    headers : { 
                    'Content-Type': 'application/json',
                    'Accept': 'application/json'
                        }
                })
                .then(res => res.json())
                .then(myJson => {
                    
                    //document.getElementById('rainfall').innerText = JSON.stringify(myJson);
                    rainfall_length = JSON.stringify(myJson["ListRainfallService"]["row"]).length

                    
                    for (var i = 0; i < rainfall_length; i++){
                        let 구명 = JSON.stringify(myJson["ListRainfallService"]["row"][i].GU_NAME);
                        if (구명 == '"노원구"'){
                            flag = i
                            break;
                        } 
                        else{
                            continue;
                        }
                    
                    }

                    //강우량
                    let 강우량 = JSON.stringify(myJson["ListRainfallService"]["row"][flag].RAINFALL10); 

                    강우량 = parseInt(강우량);

                    let 노을확률 = ""
                    if(강우량 = "0"){
                        노을확률 = "매우 높아요";
                        노을사진 = "./images/thumbsup.png"
                    }else {
                        노을확률 = "아마 보기 어려울 거에요";
                        노을사진 = "./images/thumbsdown.png"
                    }

                    document.getElementById('rainfall').innerText += "\n"+ "수락산 정상 등반 시 노을을 관찰할 확률은 " + 노을확률 ;
                    document.getElementById('rainfallpic').src = 노을사진;
                    

                    
                });
                fetch(`https://api.allorigins.win/raw?url=${encodeURIComponent('http://apis.data.go.kr/1400000/predictionInfoService/predictionInfoList?ServiceKey=pgSFXq7JRCZhMaWViaF%2FyAF0ICZWKle3przI5MSYiq%2FP89Qn8A5cHZn1RbTB56IwbIh3eTLkyuBQy%2Bv9A9PewA%3D%3D&_type=json&numOfRows=1000')}`)
                .then(response => {
                    if (response.ok) return response.json()
                    throw new Error('Network response was not ok.')
                })
                .then(myJson => {
                //document.getElementById('landslide').innerText = JSON.stringify(myJson);
                //console.log(JSON.stringify(myJson['response']['body']['items']['item']));
                console.log(JSON.stringify(myJson['response']['body']['items']['item'][0]));

                const landslide_length = JSON.stringify(myJson['response']['body']['items']['item'].length);

                var obj = [];
                for (var i = 0; i < landslide_length; i++){
                    const name = JSON.stringify(myJson['response']['body']['items']['item'][i].sgg);
                    console.log(JSON.stringify(myJson['response']['body']['items']['item'][i].sgg));

                    obj[JSON.stringify(myJson['response']['body']['items']['item'][i].sgg)] = (obj[JSON.stringify(myJson['response']['body']['items']['item'][i].sgg)] || 0) + 1;
                }    
                    console.log(obj)
                
                
                    for (var key in obj){
                    let 산사태예보 = ""
                    if(obj[key]> 20 ){
                        산사태예보  = "의 산사태 가능성이 높으므로, 등산 하지 마세요!";
                    }else if (obj[key]> 15){
                        산사태예보  = "의 산사태 가능성이 보통이므로, 등산하는 걸 자제하세요!";
                    }else if (obj[key]> 10){
                        산사태예보  = "의 산사태 가능성이 낮으므로, 안전한 편이에요!";
                    }else if (obj[key]> 5){
                        산사태예보  = "의 산사태 가능성이 매우 낮으므로, 안전해요:)";
                    }else {
                        산사태예보  = "의 산사태 예측 정보 시스템이 점검 중이어서 정보 제공이 어렵습니다.";
                    }
                    
                    if(key=='"서울특별시 노원구"'){
                    document.getElementById('landslide').innerText +="수락산"+ 산사태예보 ;
                    //콘솔창에 지역 확인
                }
            }
                });
        </script>
    </body>
</html>