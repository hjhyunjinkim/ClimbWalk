<html>
    <head>
        <meta charset = "utf-8">
        <title>아차산</title>
        <link rel = "stylesheet" type = "text/css" href = "minor.css">
        <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">
    </head>
    <body>
        <h1 id = "locationtitle">여기는 아차산!</h1>        
        
        <div>
            <div id = "container">
                <h1>노을 볼 확률</h1>
                <div id ="sunset"></div>
                <p id="rainfall"></p>
                <img id="rainfallpic">
                <p id="landslide"></p>
                <p id="trailinfo"></p>
                <p id="firealert">아차산의 산불 위험 지수는 평균보다 현저히 낮으므로 안전합니다!</p>
            </div>
            <div id="info">
                <hr>
                <h2>산 정보</h2>
                <p>서울시와 구리시에 걸쳐 있는 아차산은 해발 3백m밖에 되지 않은 야트막한 산이지만, 삼국시대의 전략요충지로 특히 온달장군의 전설이 많이 전해져 온다. 구리시 아치울에서는 해마다 온달장군 추모제가 열린다. 온달장군 전설을 간직한 아차산은 서울에서 가까워 가족나들이 코스로 적합하다.</p>
                <p>가족과 함께 삼국시대로 역사여행을 떠날 생각이라면 구리시에서 만든 아차산 문화유적지 순례 안내도가 도움이 된다. 워커힐 호텔에서 구리시로 넘어가는 검문소 주변 우미내 마을의 무료주차장(약 1백대 수용)에서 산행을 시작하면 약 2시간 정도 걸린다.</p>
                <p>이론도 없지 않지만, 이 지역 주민들은 고양시 고봉산에서 출정한 온달장군이 아차산에서 전사했다고 믿고 있다. 이를 증명이라도 하듯 가장 먼저 만나는 것이 '온달샘'이라 불리는 약수터다.온달이 가지고 놀았다는 전설이 서린 지름 3m짜리 공기돌 바위도 멀지 않은 곳에 있다. 고구려가 전쟁에 대비해 만든 소규모 요새지인 보루성도 아차산 정상주요부분에 산재해 있다.</p>
                <hr>
                <h2>편의 시설</h2>
                <p>석관 약수터, 동죽천 약수터, 보루성 약수터, 동화천 약수터, 형제 약수터 등이 있습니다. </p>
                <hr>
                <h2>볼거리</h2>
                <p>아차산성, 천연 암굴, 석곽분, 다비터, 봉수대, 강신샘</p>
                <hr>
            </div>
            
            <div id="sightseeing">
                <h5>제 1코스</h5>
                <p>구의동 화양사 - 팔각정 - 정상 - 용마봉 - 대원 외국어 고교</p>
                <h5>제 2코스</h5>
                <p>광장동 동의 국교옆 주차장 - 능선 팔각정 - 정상 - 용마산 긴고랑 - 체육공원</p>
            </div>

        <script>
            
            
            const url_rainfall = "http://openAPI.seoul.go.kr:8088/6c4a6d756673657233346142775674/json/ListRainfallService/1/100/";
                fetch(url_rainfall, {
                    headers : { 
                    'Content-Type': 'application/json',
                    'Accept': 'application/json'
                        }
                })
                .then(res => res.json())
                .then(myJson => {
                    
                    //document.getElementById('rainfall').innerText = JSON.stringify(myJson);
                    rainfall_length = JSON.stringify(myJson["ListRainfallService"]["row"]).length

                    
                    for (var i = 0; i < rainfall_length; i++){
                        let 구명 = JSON.stringify(myJson["ListRainfallService"]["row"][i].GU_NAME);
                        if (구명 == '"중랑구"'){
                            flag = i
                            break;
                        } 
                        else{
                            continue;
                        }
                    
                    }

                    //강우량
                    let 강우량 = JSON.stringify(myJson["ListRainfallService"]["row"][flag].RAINFALL10); 

                    강우량 = parseInt(강우량);

                    let 노을확률 = ""
                    if(강우량 = "0"){
                        노을확률 = "매우 높아요";
                        노을사진 = "./images/thumbsup.png"
                    }else {
                        노을확률 = "아마 보기 어려울 거에요";
                        노을사진 = "./images/thumbsdown.png"
                    }

                    document.getElementById('rainfall').innerText += "\n"+ "아차산 정상 등반 시 노을을 관찰할 확률은 " + 노을확률 ;
                    document.getElementById('rainfallpic').src = 노을사진;
                    

                    
                });
                fetch(`https://api.allorigins.win/raw?url=${encodeURIComponent('http://apis.data.go.kr/1400000/predictionInfoService/predictionInfoList?ServiceKey=pgSFXq7JRCZhMaWViaF%2FyAF0ICZWKle3przI5MSYiq%2FP89Qn8A5cHZn1RbTB56IwbIh3eTLkyuBQy%2Bv9A9PewA%3D%3D&_type=json&numOfRows=1000')}`)
                .then(response => {
                    if (response.ok) return response.json()
                    throw new Error('Network response was not ok.')
                })
                .then(myJson => {
                //document.getElementById('landslide').innerText = JSON.stringify(myJson);
                //console.log(JSON.stringify(myJson['response']['body']['items']['item']));
                console.log(JSON.stringify(myJson['response']['body']['items']['item'][0]));

                const landslide_length = JSON.stringify(myJson['response']['body']['items']['item'].length);

                var obj = [];
                for (var i = 0; i < landslide_length; i++){
                    const name = JSON.stringify(myJson['response']['body']['items']['item'][i].sgg);
                    console.log(JSON.stringify(myJson['response']['body']['items']['item'][i].sgg));

                    obj[JSON.stringify(myJson['response']['body']['items']['item'][i].sgg)] = (obj[JSON.stringify(myJson['response']['body']['items']['item'][i].sgg)] || 0) + 1;
                }    
                    console.log(obj)
                
                
                    for (var key in obj){
                    let 산사태예보 = ""
                    if(obj[key]> 20 ){
                        산사태예보  = "의 산사태 가능성이 높으므로, 등산 하지 마세요!";
                    }else if (obj[key]> 15){
                        산사태예보  = "의 산사태 가능성이 보통이므로, 등산하는 걸 자제하세요!";
                    }else if (obj[key]> 10){
                        산사태예보  = "의 산사태 가능성이 낮으므로, 안전한 편이에요!";
                    }else if (obj[key]> 5){
                        산사태예보  = "의 산사태 가능성이 매우 낮으므로, 안전해요:)";
                    }else {
                        산사태예보  = "의 산사태 예측 정보 시스템이 점검 중이어서 정보 제공이 어렵습니다.";
                    }
                    
                    if(key=='"서울특별시 중랑구"'){
                    document.getElementById('landslide').innerText +="아차산"+ 산사태예보 ;
                    //콘솔창에 지역 확인
                }
            }
                });
        </script>
    </body>
</html>